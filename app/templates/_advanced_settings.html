<hr class="my-4">
<div class="mb-3 card p-3">
  <h4>Advanced Settings</h4>
  <p class="form-text">Fine-tune background refresh, caching, scheduler throughput, and Docker timeouts. Changes are applied on next restart.</p>

  <div class="row g-3">
    <div class="col-md-3">
      <label class="form-label">Docker cache duration (s)</label>
      <input type="number" class="form-control" id="env_DDC_DOCKER_CACHE_DURATION" name="env_DDC_DOCKER_CACHE_DURATION" min="1" max="3600" value="{{ (config.env.DDC_DOCKER_CACHE_DURATION if config.env else '') or '' }}" placeholder="30">
    </div>
    <div class="col-md-3">
      <label class="form-label">Docker query cooldown (s)</label>
      <input type="number" class="form-control" id="env_DDC_DOCKER_QUERY_COOLDOWN" name="env_DDC_DOCKER_QUERY_COOLDOWN" min="0" max="60" value="{{ (config.env.DDC_DOCKER_QUERY_COOLDOWN if config.env else '') or '' }}" placeholder="2">
    </div>
    <div class="col-md-3">
      <label class="form-label">Docker max cache age (s)</label>
      <input type="number" class="form-control" id="env_DDC_DOCKER_MAX_CACHE_AGE" name="env_DDC_DOCKER_MAX_CACHE_AGE" min="1" max="7200" value="{{ (config.env.DDC_DOCKER_MAX_CACHE_AGE if config.env else '') or '' }}" placeholder="300">
    </div>
    <div class="col-md-3 d-flex align-items-end">
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="env_DDC_ENABLE_BACKGROUND_REFRESH" name="env_DDC_ENABLE_BACKGROUND_REFRESH" value="true" {% if (not config.env) or (config.env and (config.env.get('DDC_ENABLE_BACKGROUND_REFRESH') is none or (config.env.get('DDC_ENABLE_BACKGROUND_REFRESH')|string).lower() in ['1','true','on'])) %}checked{% endif %}>
        <label class="form-check-label" for="env_DDC_ENABLE_BACKGROUND_REFRESH">
          Enable background refresh
          <i class="bi bi-question-circle help-icon" data-bs-toggle="tooltip" title="Runs a background worker to refresh Docker container data periodically for instant UI updates. Default: enabled."></i>
        </label>
      </div>
    </div>
  </div>

  <div class="row g-3 mt-1">
    <div class="col-md-3">
      <label class="form-label">Background refresh interval (s)</label>
      <input type="number" class="form-control" id="env_DDC_BACKGROUND_REFRESH_INTERVAL" name="env_DDC_BACKGROUND_REFRESH_INTERVAL" min="30" max="3600" value="{{ (config.env.DDC_BACKGROUND_REFRESH_INTERVAL if config.env else '') or '' }}" placeholder="300">
    </div>
    <div class="col-md-3">
      <label class="form-label">Background refresh limit</label>
      <input type="number" class="form-control" id="env_DDC_BACKGROUND_REFRESH_LIMIT" name="env_DDC_BACKGROUND_REFRESH_LIMIT" min="1" max="1000" value="{{ (config.env.DDC_BACKGROUND_REFRESH_LIMIT if config.env else '') or '' }}" placeholder="50">
    </div>
    <div class="col-md-3">
      <label class="form-label">Background refresh timeout (s)</label>
      <input type="number" class="form-control" id="env_DDC_BACKGROUND_REFRESH_TIMEOUT" name="env_DDC_BACKGROUND_REFRESH_TIMEOUT" min="5" max="300" value="{{ (config.env.DDC_BACKGROUND_REFRESH_TIMEOUT if config.env else '') or '' }}" placeholder="30">
    </div>
    <div class="col-md-3">
      <label class="form-label">Max containers display</label>
      <input type="number" class="form-control" id="env_DDC_MAX_CONTAINERS_DISPLAY" name="env_DDC_MAX_CONTAINERS_DISPLAY" min="1" max="500" value="{{ (config.env.DDC_MAX_CONTAINERS_DISPLAY if config.env else '') or '' }}" placeholder="100">
    </div>
  </div>

  <div class="card bg-secondary mb-3 mt-3">
    <div class="card-header text-light">
      <h6 class="mb-0"><i class="bi bi-speedometer2"></i> Scheduler Throughput</h6>
    </div>
    <div class="card-body">
      <div class="row g-3">
        <div class="col-md-4">
          <label class="form-label">Scheduler check interval (s)</label>
          <input type="number" class="form-control" id="env_DDC_SCHEDULER_CHECK_INTERVAL" name="env_DDC_SCHEDULER_CHECK_INTERVAL" min="1" max="300" value="{{ (config.env.DDC_SCHEDULER_CHECK_INTERVAL if config.env else '') or '' }}" placeholder="10">
        </div>
        <div class="col-md-4">
          <label class="form-label">Max concurrent tasks</label>
          <input type="number" class="form-control" id="env_DDC_MAX_CONCURRENT_TASKS" name="env_DDC_MAX_CONCURRENT_TASKS" min="1" max="50" value="{{ (config.env.DDC_MAX_CONCURRENT_TASKS if config.env else '') or '' }}" placeholder="3">
        </div>
        <div class="col-md-4">
          <label class="form-label">Task batch size</label>
          <input type="number" class="form-control" id="env_DDC_TASK_BATCH_SIZE" name="env_DDC_TASK_BATCH_SIZE" min="1" max="100" value="{{ (config.env.DDC_TASK_BATCH_SIZE if config.env else '') or '' }}" placeholder="5">
        </div>
      </div>
    </div>
  </div>

  <div class="card bg-secondary">
    <div class="card-header text-light">
      <h6 class="mb-0"><i class="bi bi-clock-history"></i> Docker Timeouts (advanced)</h6>
    </div>
    <div class="card-body">
      <div class="row g-3">
        <div class="col-md-4">
          <label class="form-label">Fast stats timeout (s)</label>
          <input type="number" class="form-control" id="env_DDC_FAST_STATS_TIMEOUT" name="env_DDC_FAST_STATS_TIMEOUT" min="1" max="60" value="{{ (config.env.DDC_FAST_STATS_TIMEOUT if config.env else '') or '' }}" placeholder="10">
        </div>
        <div class="col-md-4">
          <label class="form-label">Slow stats timeout (s)</label>
          <input type="number" class="form-control" id="env_DDC_SLOW_STATS_TIMEOUT" name="env_DDC_SLOW_STATS_TIMEOUT" min="1" max="300" value="{{ (config.env.DDC_SLOW_STATS_TIMEOUT if config.env else '') or '' }}" placeholder="30">
        </div>
        <div class="col-md-4">
          <label class="form-label">Container list timeout (s)</label>
          <input type="number" class="form-control" id="env_DDC_CONTAINER_LIST_TIMEOUT" name="env_DDC_CONTAINER_LIST_TIMEOUT" min="1" max="120" value="{{ (config.env.DDC_CONTAINER_LIST_TIMEOUT if config.env else '') or '' }}" placeholder="15">
        </div>
      </div>
    </div>
  </div>
</div>

